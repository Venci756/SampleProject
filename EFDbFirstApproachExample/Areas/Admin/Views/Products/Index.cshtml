@model List<EFDbFirstApproachExample.Models.Product>
    @{
    ViewBag.Title = "Products";
    Layout = "~/Areas/Admin/Views/Shared/AdminLayoutPage1.cshtml";
    }

    <h2>Products</h2>
    <a href="/admin/products/create">Create</a>
    <form class="form-inline" action="/admin/products/index">
        @Html.Label("Search", new { @class = "mr-1" })
        @Html.TextBox("Search", ViewBag.search as string, new { @class = "form-control mr-1", placeholder = "Search" })
        @*
        <label for="search">Search</label>
        <input type="search" class="form-control" id="search" name="search" value="search" />
        *@
        <button type="submit" class="btn btn-primary">GO</button>
    </form>
    <table class="table">
        <tr class="table-secondary">
            <th style="width:10%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=ProductID&IconClass=fa-sort-asc&PageNo=1">Product ID</a>
                if (ViewBag.SortColumn == "ProductID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=ProductID&IconClass=fa-sort-desc&PageNo=1">Product ID</a>
                if (ViewBag.SortColumn == "ProductID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:30%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=ProductName&IconClass=fa-sort-asc&PageNo=1">Product Name</a>
                if (ViewBag.SortColumn == "ProductName")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=ProductName&IconClass=fa-sort-desc&PageNo=1">Product Name</a>
                if (ViewBag.SortColumn == "ProductName")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:30%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=ProductName&IconClass=fa-sort-asc&PageNo=1">Authors</a>
                if (ViewBag.SortColumn == "Authors")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=ProductName&IconClass=fa-sort-desc&PageNo=1">Authors</a>
                if (ViewBag.SortColumn == "Authors")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:5%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=Price&IconClass=fa-sort-asc&PageNo=1">Price</a>
                if (ViewBag.SortColumn == "Price")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=Price&IconClass=fa-sort-desc&PageNo=1">Price</a>
                if (ViewBag.SortColumn == "Price")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:10%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=DateOfPurpose&IconClass=fa-sort-asc&PageNo=1">Date of Purchase</a>
                if (ViewBag.SortColumn == "DateOfPurpose")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=DateOfPurpose&IconClass=fa-sort-desc&PageNo=1">Date of Purchase</a>
                if (ViewBag.SortColumn == "DateOfPurpose")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:10%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=AvailabilityStatus&IconClass=fa-sort-asc&PageNo=1">Availability Status</a>
                if (ViewBag.SortColumn == "AvailabilityStatus")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=AvailabilityStatus&IconClass=fa-sort-desc&PageNo=1">Availability Status</a>
                if (ViewBag.SortColumn == "AvailabilityStatus")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:10%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=CategoryID&IconClass=fa-sort-asc&PageNo=1">Category ID</a>
                if (ViewBag.SortColumn == "CategoryID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=CategoryID&IconClass=fa-sort-desc&PageNo=1">Category ID</a>
                if (ViewBag.SortColumn == "CategoryID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:5%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=PublisherID&IconClass=fa-sort-asc&PageNo=1">Publisher ID</a>
                if (ViewBag.SortColumn == "PublisherID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=PublisherID&IconClass=fa-sort-desc&PageNo=1">Pubisher ID</a>
                if (ViewBag.SortColumn == "PublisherID")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:10%">
                @if (ViewBag.IconClass == "fa-sort-desc")
                {
                <a href="/admin/products/index?SortColumn=Active&IconClass=fa-sort-asc&PageNo=1">Active</a>
                if (ViewBag.SortColumn == "Active")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
                else
                {
                <a href="/admin/products/index?SortColumn=Active&IconClass=fa-sort-desc&PageNo=1">Active</a>
                if (ViewBag.SortColumn == "Active")
                {
                <i class="fa @ViewBag.IconClass"></i>
                }
                }
            </th>
            <th style="width:10%"></th>
        </tr>
        @foreach (var item in Model)
        {
        <tr>
            <td>@Html.DisplayFor(temp => item.ProductID)</td>
            <td>@Html.DisplayFor(temp => item.ProductName)</td>
            <td>@Html.DisplayFor(temp => item.Authors)</td>
            <td>@Html.DisplayFor(temp => item.Price)</td>
            @*
            <td>@item.Price.Value.ToString("C")</td>*@
            <td>@Html.DisplayFor(temp => item.DateOfPurpose)</td>
            @*
            <td>@item.DateOfPurpose.Value.ToString("dd/M/yyyy")</td>*@
            <td>@Html.DisplayFor(temp => item.AvailabilityStatus)</td>
            @*
            <td>@item.AvailabilityStatus</td>*@
            <td>@Html.DisplayFor(temp => item.Category.CategoryName)</td>
            @*
            <td>@item.Category.CategoryName</td>*@
            <td>@Html.DisplayFor(temp => item.Publisher.PublisherName)</td>
            @*
            <td>@item.Publisher.PublisherName</td>*@
            <td>@Html.DisplayFor(temp => item.Active)</td>
            @*
            <td>@item.Active</td>*@
            <td><img src="data:image;base64,@item.Image" /></td>
            <td>
                @Html.ActionLink("Details","Details", new{id = item.ProductID, Controller = "Products", area = "Admin"})
                @Html.ActionLink("Edit","Edit", new { id = item.ProductID, Controller = "Products", area = "Admin" })
                @Html.ActionLink("Delete","Delete", new {id = item.ProductID, Controller = "Products", area = "Admin"})
                @*<a href="/products/details/@item.ProductID">Details</a>
                <a href="/products/Edit/@item.ProductID">Edit</a>
                <a href="/products/delete/@item.ProductID">Delete</a>*@
            </td>
        </tr>
        }
        <tr>
            <td colspan="9">
                @{
                int PrevPageNo = ViewBag.PageNo - 1;
                if (PrevPageNo <= 0)
                {
                PrevPageNo = 1;
                }
                int NextPageNo = ViewBag.PageNo + 1;
                if(NextPageNo > ViewBag.NoOfPages)
                {
                NextPageNo = ViewBag.NoOfPages;
                }
                }
                <ul class="pagination justify-content-center">
                    <li class="page-item">
                        <a class="page-link" href="/admin/products/index?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@PrevPageNo">Prev</a>
                    </li>
                    @{
                    for (int i = 0; i < ViewBag.NoOfPages; i++)
                    {
                    if ((i + 1) == ViewBag.PageNo)
                    {
                    <li class="page-item active">
                        <a class="page-link active" href="/admin/products/index?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@(i+1)">@(i + 1)</a>
                    </li>
                    }
                    else
                    {
                    <li class="page-item">
                        <a class="page-link" href="/admin/products/index?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@(i+1)">@(i + 1)</a>
                    </li>
                    }

                    }
                    }
                    <li class="page-item">
                        <a class="page-link" href="/admin/products/index?SortColumn=@ViewBag.SortColumn&IconClass=@ViewBag.IconClass&PageNo=@NextPageNo">Next</a>
                    </li>

                </ul>
            </td>
        </tr>
    </table>

